shadow$provide.module$node_modules$$codemirror$autocomplete$dist$index_cjs=function(global,require,module,exports){function toSet(chars){chars=Object.keys(chars).join("");let words=/\w/.test(chars);words&&(chars=chars.replace(/\w/g,""));return`[${words?"\\w":""}${chars.replace(/[^\w\s]/g,"\\$\x26")}]`}function prefixMatch(options){var first=Object.create(null);let rest=Object.create(null);for(let {label}of options)for(first[label[0]]=!0,options=1;options<label.length;options++)rest[label[options]]=
!0;first=toSet(first)+toSet(rest)+"*$";return[new RegExp("^"+first),new RegExp(first)]}function completeFromList(list){let options=list.map(o=>"string"==typeof o?{label:o}:o),[validFor,match]=options.every(o=>/^\w+$/.test(o.label))?[/\w*$/,/\w+$/]:prefixMatch(options);return context=>{let token=context.matchBefore(match);return token||context.explicit?{from:token?token.from:context.pos,options,validFor}:null}}function cur(state){return state.selection.main.head}function ensureAnchor(expr,start){var _a;
let {source}=expr;start=start&&"^"!=source[0];let addEnd="$"!=source[source.length-1];return start||addEnd?new RegExp(`${start?"^":""}(?:${source})${addEnd?"$":""}`,null!==(_a=expr.flags)&&void 0!==_a?_a:expr.ignoreCase?"i":""):expr}function insertCompletionText(state$1,text,from,to){return Object.assign(Object.assign({},state$1.changeByRange(range=>{if(range==state$1.selection.main)return{changes:{from,to,insert:text},range:state$jscomp$0.EditorSelection.cursor(from+text.length)};let len=to-from;
return!range.empty||len&&state$1.sliceDoc(range.from-len,range.from)!=state$1.sliceDoc(from,to)?{range}:{changes:{from:range.from-len,to:range.from,insert:text},range:state$jscomp$0.EditorSelection.cursor(range.from-len+text.length)}})),{userEvent:"input.complete"})}function applyCompletion(view,option){const apply=option.completion.apply||option.completion.label;let result=option.source;"string"==typeof apply?view.dispatch(insertCompletionText(view.state,apply,result.from,result.to)):apply(view,
option.completion,result.from,result.to)}function asSource(source){if(!Array.isArray(source))return source;let known=SourceCache.get(source);known||SourceCache.set(source,known=completeFromList(source));return known}function optionContent(config){let content=config.addToOptions.slice();config.icons&&content.push({render(completion){let icon=document.createElement("div");icon.classList.add("cm-completionIcon");completion.type&&icon.classList.add(...completion.type.split(/\s+/g).map(cls=>"cm-completionIcon-"+
cls));icon.setAttribute("aria-hidden","true");return icon},position:20});content.push({render(completion,_s,match){_s=document.createElement("span");_s.className="cm-completionLabel";({label:completion}=completion);var off=0;for(let j=1;j<match.length;){let from=match[j++],to=match[j++];from>off&&_s.appendChild(document.createTextNode(completion.slice(off,from)));off=_s.appendChild(document.createElement("span"));off.appendChild(document.createTextNode(completion.slice(from,to)));off.className="cm-completionMatchedText";
off=to}off<completion.length&&_s.appendChild(document.createTextNode(completion.slice(off)));return _s},position:50},{render(completion){if(!completion.detail)return null;let detailElt=document.createElement("span");detailElt.className="cm-completionDetail";detailElt.textContent=completion.detail;return detailElt},position:80});return content.sort((a,b)=>a.position-b.position).map(a=>a.render)}function rangeAroundSelected(total,selected,max){if(total<=max)return{from:0,to:total};if(selected<=total>>
1)return total=Math.floor(selected/max),{from:total*max,to:(total+1)*max};selected=Math.floor((total-selected)/max);return{from:total-(selected+1)*max,to:total-selected*max}}function completionTooltip(stateField){return view=>new CompletionTooltip(view,stateField)}function score$jscomp$0(option){return 100*(option.boost||0)+(option.apply?10:0)+(option.info?5:0)+(option.type?1:0)}function sortOptions(active,state){let options=[];var i=0;for(let a of active)if(a.hasResult())if(!1===a.result.filter){active=
a.result.getMatch;for(let option of a.result.options){var match=[1E9-i++];if(active)for(let n of active(option))match.push(n);options.push(new Option(option,a,match))}}else{active=new FuzzyMatcher(state.sliceDoc(a.from,a.to));for(let option of a.result.options)if(match=active.match(option.label))null!=option.boost&&(match[0]+=option.boost),options.push(new Option(option,a,match))}state=[];i=null;for(let opt of options.sort(cmpOption))!i||i.label!=opt.completion.label||i.detail!=opt.completion.detail||
null!=i.type&&null!=opt.completion.type&&i.type!=opt.completion.type||i.apply!=opt.completion.apply?state.push(opt):score$jscomp$0(opt.completion)>score$jscomp$0(i)&&(state[state.length-1]=opt),i=opt.completion;return state}function sameResults(a,b){if(a==b)return!0;for(let iA=0,iB=0;;){for(;iA<a.length&&!a[iA].hasResult;)iA++;for(;iB<b.length&&!b[iB].hasResult;)iB++;let endA=iA==a.length,endB=iB==b.length;if(endA||endB)return endA==endB;if(a[iA++].result!=b[iB++].result)return!1}}function makeAttrs(id,
selected){return{"aria-autocomplete":"list","aria-haspopup":"listbox","aria-activedescendant":id+"-"+selected,"aria-controls":id}}function cmpOption(a,b){let dScore=b.match[0]-a.match[0];return dScore?dScore:a.completion.label.localeCompare(b.completion.label)}function getUserEvent(tr){return tr.isUserEvent("input.type")?"input":tr.isUserEvent("delete.backward")?"delete":null}function moveCompletionSelection(forward,by="option"){return view$1=>{var cState=view$1.state.field(completionState,!1);if(!cState||
!cState.open||75>Date.now()-cState.open.timestamp)return!1;var step=1;let tooltip;"page"==by&&(tooltip=view$jscomp$0.getTooltip(view$1,cState.open.tooltip))&&(step=Math.max(2,Math.floor(tooltip.dom.offsetHeight/tooltip.dom.querySelector("li").offsetHeight)-1));step=cState.open.selected+step*(forward?1:-1);({length:cState}=cState.open.options);0>step?step="page"==by?0:cState-1:step>=cState&&(step="page"==by?cState-1:0);view$1.dispatch({effects:setSelectedEffect.of(step)});return!0}}function fieldSelection(ranges,
field){return state$jscomp$0.EditorSelection.create(ranges.filter(r=>r.field==field).map(r=>state$jscomp$0.EditorSelection.range(r.from,r.to)))}function snippet(template){let snippet=Snippet.parse(template);return(editor,_completion,from,to)=>{let {text,ranges}=snippet.instantiate(editor.state,from);_completion={changes:{from,to,insert:state$jscomp$0.Text.of(text)},scrollIntoView:!0};ranges.length&&(_completion.selection=fieldSelection(ranges,0));1<ranges.length&&(from=new ActiveSnippet(ranges,0),
from=_completion.effects=[setActive.of(from)],void 0===editor.state.field(snippetState,!1)&&from.push(state$jscomp$0.StateEffect.appendConfig.of([snippetState,addSnippetKeymap,snippetPointerHandler,baseTheme])));editor.dispatch(editor.state.update(_completion))}}function moveField(dir){return({state,dispatch})=>{let active=state.field(snippetState,!1);if(!active||0>dir&&0==active.active)return!1;let next=active.active+dir,last=0<dir&&!active.ranges.some(r=>r.field==next+dir);dispatch(state.update({selection:fieldSelection(active.ranges,
next),effects:setActive.of(last?null:new ActiveSnippet(active.ranges,next))}));return!0}}function wordRE(wordChars){wordChars=wordChars.replace(/[\\[.+*?(){|^$]/g,"\\$\x26");try{return new RegExp(`[\\p{Alphabetic}\\p{Number}_${wordChars}]+`,"ug")}catch(_a){return new RegExp(`[\w${wordChars}]`,"g")}}function mapRE(re,f){return new RegExp(f(re.source),re.unicode?"u":"")}function storeWords(doc,wordRE,result,seen,ignoreAt){for(let lines=doc.iterLines(),pos=0;!lines.next().done;){({value:doc}=lines);
let m;for(wordRE.lastIndex=0;m=wordRE.exec(doc);)if(!seen[m[0]]&&pos+m.index!=ignoreAt&&(result.push({type:"text",label:m[0]}),seen[m[0]]=!0,2E3<=result.length))return;pos+=doc.length+1}}function collectWords(doc,cache,wordRE,to,ignoreAt){let big=1E3<=doc.length;var cached=big&&cache.get(doc);if(cached)return cached;cached=[];let seen=Object.create(null);if(doc.children){let pos=0;for(let ch of doc.children){if(1E3<=ch.length)for(let c of collectWords(ch,cache,wordRE,to-pos,ignoreAt-pos))seen[c.label]||
(seen[c.label]=!0,cached.push(c));else storeWords(ch,wordRE,cached,seen,ignoreAt-pos);pos+=ch.length+1}}else storeWords(doc,wordRE,cached,seen,ignoreAt);big&&2E3>cached.length&&cache.set(doc,cached);return cached}function closing(ch){for(let i=0;8>i;i+=2)if("()[]{}\x3c\x3e".charCodeAt(i)==ch)return"()[]{}\x3c\x3e".charAt(i+1);return state$jscomp$0.fromCodePoint(128>ch?ch:ch+1)}function insertBracket(state$1,bracket){let conf=state$1.languageDataAt("closeBrackets",state$1.selection.main.head)[0]||
defaults,tokens=conf.brackets||defaults.brackets;for(let tok of tokens){let closed=closing(state$jscomp$0.codePointAt(tok,0));if(bracket==tok)return closed==tok?handleSame(state$1,tok,-1<tokens.indexOf(tok+tok+tok)):handleOpen(state$1,tok,closed,conf.before||defaults.before);if(bracket==closed&&closedBracketAt(state$1,state$1.selection.main.from))return handleClose(state$1,tok,closed)}return null}function closedBracketAt(state,pos){let found=!1;state.field(bracketState).between(0,state.doc.length,
from=>{from==pos&&(found=!0)});return found}function nextChar(doc,pos){doc=doc.sliceString(pos,pos+2);return doc.slice(0,state$jscomp$0.codePointSize(state$jscomp$0.codePointAt(doc,0)))}function handleOpen(state$1,open,close,closeBefore){let dont=null,changes=state$1.changeByRange(range=>{if(!range.empty)return{changes:[{insert:open,from:range.from},{insert:close,from:range.to}],effects:closeBracketEffect.of(range.to+open.length),range:state$jscomp$0.EditorSelection.range(range.anchor+open.length,
range.head+open.length)};let next=nextChar(state$1.doc,range.head);return!next||/\s/.test(next)||-1<closeBefore.indexOf(next)?{changes:{insert:open+close,from:range.head},effects:closeBracketEffect.of(range.head+open.length),range:state$jscomp$0.EditorSelection.cursor(range.head+open.length)}:{range:dont=range}});return dont?null:state$1.update(changes,{scrollIntoView:!0,userEvent:"input.type"})}function handleClose(state$1,_open,close){let dont=null;_open=state$1.selection.ranges.map(range=>range.empty&&
nextChar(state$1.doc,range.head)==close?state$jscomp$0.EditorSelection.cursor(range.head+close.length):dont=range);return dont?null:state$1.update({selection:state$jscomp$0.EditorSelection.create(_open,state$1.selection.mainIndex),scrollIntoView:!0,effects:state$1.selection.ranges.map(({from})=>skipBracketEffect.of(from))})}function handleSame(state$1,token,allowTriple){let dont=null,changes=state$1.changeByRange(range=>{if(!range.empty)return{changes:[{insert:token,from:range.from},{insert:token,
from:range.to}],effects:closeBracketEffect.of(range.to+token.length),range:state$jscomp$0.EditorSelection.range(range.anchor+token.length,range.head+token.length)};let pos=range.head;var next=nextChar(state$1.doc,pos);if(next==token){if(nodeStart(state$1,pos))return{changes:{insert:token+token,from:pos},effects:closeBracketEffect.of(pos+token.length),range:state$jscomp$0.EditorSelection.cursor(pos+token.length)};if(closedBracketAt(state$1,pos))return range=allowTriple&&state$1.sliceDoc(pos,pos+3*
token.length)==token+token+token,{range:state$jscomp$0.EditorSelection.cursor(pos+token.length*(range?3:1)),effects:skipBracketEffect.of(pos)}}else{if(allowTriple&&state$1.sliceDoc(pos-2*token.length,pos)==token+token&&nodeStart(state$1,pos-2*token.length))return{changes:{insert:token+token+token+token,from:pos},effects:closeBracketEffect.of(pos+token.length),range:state$jscomp$0.EditorSelection.cursor(pos+token.length)};if(state$1.charCategorizer(pos)(next)!=state$jscomp$0.CharCategory.Word){next=
state$1.sliceDoc(pos-1,pos);if(next=next!=token&&state$1.charCategorizer(pos)(next)!=state$jscomp$0.CharCategory.Word){a:{var node=language.syntaxTree(state$1).resolveInner(pos,-1);for(next=0;5>next;next++){if(state$1.sliceDoc(node.from,node.from+token.length)==token){next=!0;break a}node=node.to==pos&&node.parent;if(!node)break}next=!1}next=!next}if(next)return{changes:{insert:token+token,from:pos},effects:closeBracketEffect.of(pos+token.length),range:state$jscomp$0.EditorSelection.cursor(pos+token.length)}}}return{range:dont=
range}});return dont?null:state$1.update(changes,{scrollIntoView:!0,userEvent:"input.type"})}function nodeStart(state,pos){state=language.syntaxTree(state).resolveInner(pos+1);return state.parent&&state.from==pos}Object.defineProperty(exports,"__esModule",{value:!0});var state$jscomp$0=require("module$node_modules$$codemirror$state$dist$index_cjs"),view$jscomp$0=require("module$node_modules$$codemirror$view$dist$index_cjs"),language=require("module$node_modules$$codemirror$language$dist$index_cjs");
class CompletionContext{constructor(state,pos,explicit){this.state=state;this.pos=pos;this.explicit=explicit;this.abortListeners=[]}tokenBefore(types){let token=language.syntaxTree(this.state).resolveInner(this.pos,-1);for(;token&&0>types.indexOf(token.name);)token=token.parent;return token?{from:token.from,to:this.pos,text:this.state.sliceDoc(token.from,this.pos),type:token.type}:null}matchBefore(expr){var line=this.state.doc.lineAt(this.pos);let start=Math.max(line.from,this.pos-250);line=line.text.slice(start-
line.from,this.pos-line.from);expr=line.search(ensureAnchor(expr,!1));return 0>expr?null:{from:start+expr,to:this.pos,text:line.slice(expr)}}get aborted(){return null==this.abortListeners}addEventListener(type,listener){"abort"==type&&this.abortListeners&&this.abortListeners.push(listener)}}class Option{constructor(completion,source,match){this.completion=completion;this.source=source;this.match=match}}global=state$jscomp$0.Annotation.define();const SourceCache=new WeakMap;class FuzzyMatcher{constructor(pattern){this.pattern=
pattern;this.chars=[];this.folded=[];this.any=[];this.precise=[];this.byWord=[];for(let p=0;p<pattern.length;){var char=state$jscomp$0.codePointAt(pattern,p);let size=state$jscomp$0.codePointSize(char);this.chars.push(char);char=pattern.slice(p,p+size);let upper=char.toUpperCase();this.folded.push(state$jscomp$0.codePointAt(upper==char?char.toLowerCase():upper,0));p+=size}this.astral=pattern.length!=this.chars.length}match(word){if(0==this.pattern.length)return[0];if(word.length<this.pattern.length)return null;
let {chars,folded,any,precise,byWord}=this;if(1==chars.length)return word=state$jscomp$0.codePointAt(word,0),word==chars[0]?[0,0,state$jscomp$0.codePointSize(word)]:word==folded[0]?[-200,0,state$jscomp$0.codePointSize(word)]:null;let direct=word.indexOf(this.pattern);if(0==direct)return[0,0,this.pattern.length];let len=chars.length;var anyTo=0;if(0>direct){for(let i=0,e=Math.min(word.length,200);i<e&&anyTo<len;){var next$jscomp$0=state$jscomp$0.codePointAt(word,i);if(next$jscomp$0==chars[anyTo]||
next$jscomp$0==folded[anyTo])any[anyTo++]=i;i+=state$jscomp$0.codePointSize(next$jscomp$0)}if(anyTo<len)return null}next$jscomp$0=anyTo=0;let byWordFolded=!1,adjacentTo=0,adjacentStart=-1,adjacentEnd=-1,hasLower=/[a-z]/.test(word),wordAdjacent=!0;for(let i=0,e=Math.min(word.length,200),prevType=0;i<e&&next$jscomp$0<len;){let next=state$jscomp$0.codePointAt(word,i);0>direct&&(anyTo<len&&next==chars[anyTo]&&(precise[anyTo++]=i),adjacentTo<len&&(next==chars[adjacentTo]||next==folded[adjacentTo]?(0==
adjacentTo&&(adjacentStart=i),adjacentEnd=i+1,adjacentTo++):adjacentTo=0));let ch,type=255>next?48<=next&&57>=next||97<=next&&122>=next?2:65<=next&&90>=next?1:0:(ch=state$jscomp$0.fromCodePoint(next))!=ch.toLowerCase()?1:ch!=ch.toUpperCase()?2:0;if(!i||1==type&&hasLower||0==prevType&&0!=type)chars[next$jscomp$0]==next||folded[next$jscomp$0]==next&&(byWordFolded=!0)?byWord[next$jscomp$0++]=i:byWord.length&&(wordAdjacent=!1);prevType=type;i+=state$jscomp$0.codePointSize(next)}return next$jscomp$0==
len&&0==byWord[0]&&wordAdjacent?this.result(-100+(byWordFolded?-200:0),byWord,word):adjacentTo==len&&0==adjacentStart?[-200-word.length,0,adjacentEnd]:-1<direct?[-700-word.length,direct,direct+this.pattern.length]:adjacentTo==len?[-900-word.length,adjacentStart,adjacentEnd]:next$jscomp$0==len?this.result((byWordFolded?-200:0)+-800+(wordAdjacent?0:-1100),byWord,word):2==chars.length?null:this.result((any[0]?-700:0)+-1300,any,word)}result(score,positions,word){score=[score-word.length];let i=1;for(let pos of positions)positions=
pos+(this.astral?state$jscomp$0.codePointSize(state$jscomp$0.codePointAt(word,pos)):1),1<i&&score[i-1]==pos?score[i-1]=positions:(score[i++]=pos,score[i++]=positions);return score}}const completionConfig=state$jscomp$0.Facet.define({combine(configs){return state$jscomp$0.combineConfig(configs,{activateOnTyping:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[]},{defaultKeymap:(a,b)=>a&&b,closeOnBlur:(a,b)=>a&&b,icons:(a,
b)=>a&&b,optionClass:(a$jscomp$0,b)=>c=>{var a=a$jscomp$0(c);c=b(c);return a?c?a+" "+c:a:c},addToOptions:(a,b)=>a.concat(b)})}});class CompletionTooltip{constructor(view,stateField){this.view=view;this.stateField=stateField;this.info=null;this.placeInfo={read:()=>this.measureInfo(),write:pos=>this.positionInfo(pos),key:this};stateField=view.state.field(stateField);let {options,selected}=stateField.open,config=view.state.facet(completionConfig);this.optionContent=optionContent(config);this.optionClass=
config.optionClass;this.range=rangeAroundSelected(options.length,selected,config.maxRenderedOptions);this.dom=document.createElement("div");this.dom.className="cm-tooltip-autocomplete";this.dom.addEventListener("mousedown",e=>{for(let dom=e.target,match;dom&&dom!=this.dom;dom=dom.parentNode)if("LI"==dom.nodeName&&(match=/-(\d+)$/.exec(dom.id))&&+match[1]<options.length){applyCompletion(view,options[+match[1]]);e.preventDefault();break}});this.list=this.dom.appendChild(this.createListBox(options,stateField.id,
this.range));this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)})}mount(){this.updateSel()}update(update){update.state.field(this.stateField)!=update.startState.field(this.stateField)&&this.updateSel()}positioned(){this.info&&this.view.requestMeasure(this.placeInfo)}updateSel(){let cState=this.view.state.field(this.stateField);var open=cState.open;if(open.selected<this.range.from||open.selected>=this.range.to)this.range=rangeAroundSelected(open.options.length,
open.selected,this.view.state.facet(completionConfig).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(open.options,cState.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)});if(this.updateSelectedOption(open.selected)){this.info&&(this.info.remove(),this.info=null);({completion:open}=open.options[open.selected]);let {info}=open;info&&(open="string"===typeof info?document.createTextNode(info):info(open))&&
("then"in open?open.then(node=>{node&&this.view.state.field(this.stateField,!1)==cState&&this.addInfoPane(node)}).catch(e=>view$jscomp$0.logException(this.view.state,e,"completion info")):this.addInfoPane(open))}}addInfoPane(content){let dom=this.info=document.createElement("div");dom.className="cm-tooltip cm-completionInfo";dom.appendChild(content);this.dom.appendChild(dom);this.view.requestMeasure(this.placeInfo)}updateSelectedOption(selected){let set=null;for(let opt=this.list.firstChild,i=this.range.from;opt;opt=
opt.nextSibling,i++)i==selected?opt.hasAttribute("aria-selected")||(opt.setAttribute("aria-selected","true"),set=opt):opt.hasAttribute("aria-selected")&&opt.removeAttribute("aria-selected");if(set){selected=this.list;var element=set;let parent=selected.getBoundingClientRect();element=element.getBoundingClientRect();element.top<parent.top?selected.scrollTop-=parent.top-element.top:element.bottom>parent.bottom&&(selected.scrollTop+=element.bottom-parent.bottom)}return set}measureInfo(){var sel=this.dom.querySelector("[aria-selected]");
if(!sel||!this.info)return null;var listRect=this.dom.getBoundingClientRect();let infoRect=this.info.getBoundingClientRect();sel=sel.getBoundingClientRect();if(sel.top>Math.min(innerHeight,listRect.bottom)-10||sel.bottom<Math.max(0,listRect.top)+10)return null;sel=Math.max(0,Math.min(sel.top,innerHeight-infoRect.height))-listRect.top;let left=this.view.textDirection==view$jscomp$0.Direction.RTL,spaceLeft=listRect.left;listRect=innerWidth-listRect.right;left&&spaceLeft<Math.min(infoRect.width,listRect)?
left=!1:!left&&listRect<Math.min(infoRect.width,spaceLeft)&&(left=!0);return{top:sel,left}}positionInfo(pos){this.info&&(this.info.style.top=(pos?pos.top:-1E6)+"px",pos&&(this.info.classList.toggle("cm-completionInfo-left",pos.left),this.info.classList.toggle("cm-completionInfo-right",!pos.left)))}createListBox(options,id,range){const ul=document.createElement("ul");ul.id=id;ul.setAttribute("role","listbox");ul.setAttribute("aria-expanded","true");ul.setAttribute("aria-label",this.view.state.phrase("Completions"));
for(let i=range.from;i<range.to;i++){let {completion,match}=options[i];const li=ul.appendChild(document.createElement("li"));li.id=id+"-"+i;li.setAttribute("role","option");var cls=this.optionClass(completion);cls&&(li.className=cls);for(let source of this.optionContent)(cls=source(completion,this.view.state,match))&&li.appendChild(cls)}range.from&&ul.classList.add("cm-completionListIncompleteTop");range.to<options.length&&ul.classList.add("cm-completionListIncompleteBottom");return ul}}class CompletionDialog{constructor(options,
attrs,tooltip,timestamp,selected){this.options=options;this.attrs=attrs;this.tooltip=tooltip;this.timestamp=timestamp;this.selected=selected}setSelected(selected,id){return selected==this.selected||selected>=this.options.length?this:new CompletionDialog(this.options,makeAttrs(id,selected),this.tooltip,this.timestamp,selected)}static build(active,state,id,prev,conf){state=sortOptions(active,state);if(!state.length)return null;let selected=0;if(prev&&prev.selected){let selectedValue=prev.options[prev.selected].completion;
for(let i=0;i<state.length;i++)if(state[i].completion==selectedValue){selected=i;break}}return new CompletionDialog(state,makeAttrs(id,selected),{pos:active.reduce((a,b)=>b.hasResult()?Math.min(a,b.from):a,1E8),create:completionTooltip(completionState),above:conf.aboveCursor},prev?prev.timestamp:Date.now(),selected)}map(changes){return new CompletionDialog(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:changes.mapPos(this.tooltip.pos)}),this.timestamp,this.selected)}}class CompletionState{constructor(active,
id,open){this.active=active;this.id=id;this.open=open}static start(){return new CompletionState(none,"cm-ac-"+Math.floor(2E6*Math.random()).toString(36),null)}update(tr){var {state}=tr;let conf=state.facet(completionConfig),active=(conf.override||state.languageDataAt("autocomplete",cur(state)).map(asSource)).map(source=>(this.active.find(s=>s.source==source)||new ActiveSource(source,this.active.some(a=>0!=a.state)?1:0)).update(tr,conf));active.length==this.active.length&&active.every((a,i)=>a==this.active[i])&&
(active=this.active);state=tr.selection||active.some(a=>a.hasResult()&&tr.changes.touchesRange(a.from,a.to))||!sameResults(active,this.active)?CompletionDialog.build(active,state,this.id,this.open,conf):this.open&&tr.docChanged?this.open.map(tr.changes):this.open;!state&&active.every(a=>1!=a.state)&&active.some(a=>a.hasResult())&&(active=active.map(a=>a.hasResult()?new ActiveSource(a.source,0):a));for(let effect of tr.effects)effect.is(setSelectedEffect)&&(state=state&&state.setSelected(effect.value,
this.id));return active==this.active&&state==this.open?this:new CompletionState(active,this.id,state)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:baseAttrs}}const baseAttrs={"aria-autocomplete":"list"},none=[];class ActiveSource{constructor(source,state,explicitPos=-1){this.source=source;this.state=state;this.explicitPos=explicitPos}hasResult(){return!1}update(tr,conf){let event=getUserEvent(tr),value=this;event?value=value.handleUserEvent(tr,
event,conf):tr.docChanged?value=value.handleChange(tr):tr.selection&&0!=value.state&&(value=new ActiveSource(value.source,0));for(let effect of tr.effects)if(effect.is(startCompletionEffect))value=new ActiveSource(value.source,1,effect.value?cur(tr.state):-1);else if(effect.is(closeCompletionEffect))value=new ActiveSource(value.source,0);else if(effect.is(setActiveEffect))for(let active of effect.value)active.source==value.source&&(value=active);return value}handleUserEvent(tr,type,conf){return"delete"!=
type&&conf.activateOnTyping?new ActiveSource(this.source,1):this.map(tr.changes)}handleChange(tr){return tr.changes.touchesRange(cur(tr.startState))?new ActiveSource(this.source,0):this.map(tr.changes)}map(changes){return changes.empty||0>this.explicitPos?this:new ActiveSource(this.source,this.state,changes.mapPos(this.explicitPos))}}class ActiveResult extends ActiveSource{constructor(source,explicitPos,result,from,to){super(source,2,explicitPos);this.result=result;this.from=from;this.to=to}hasResult(){return!0}handleUserEvent(tr,
type,conf){var _a;let from=tr.changes.mapPos(this.from),to=tr.changes.mapPos(this.to,1),pos=cur(tr.state);if((0>this.explicitPos?pos<=from:pos<this.from)||pos>to||"delete"==type&&cur(tr.startState)==this.from)return new ActiveSource(this.source,"input"==type&&conf.activateOnTyping?1:0);type=0>this.explicitPos?-1:tr.changes.mapPos(this.explicitPos);let updated;conf=this.result.validFor;var state=tr.state;if(conf){var text=state.sliceDoc(from,to);conf="function"==typeof conf?conf(text,from,to,state):
ensureAnchor(conf,!0).test(text)}else conf=!1;return conf?new ActiveResult(this.source,type,this.result,from,to):this.result.update&&(updated=this.result.update(this.result,from,to,new CompletionContext(tr.state,pos,0<=type)))?new ActiveResult(this.source,type,updated,updated.from,null!==(_a=updated.to)&&void 0!==_a?_a:cur(tr.state)):new ActiveSource(this.source,1,type)}handleChange(tr){return tr.changes.touchesRange(this.from,this.to)?new ActiveSource(this.source,0):this.map(tr.changes)}map(mapping){return mapping.empty?
this:new ActiveResult(this.source,0>this.explicitPos?-1:mapping.mapPos(this.explicitPos),this.result,mapping.mapPos(this.from),mapping.mapPos(this.to,1))}}const startCompletionEffect=state$jscomp$0.StateEffect.define(),closeCompletionEffect=state$jscomp$0.StateEffect.define(),setActiveEffect=state$jscomp$0.StateEffect.define({map(sources,mapping){return sources.map(s=>s.map(mapping))}}),setSelectedEffect=state$jscomp$0.StateEffect.define(),completionState=state$jscomp$0.StateField.define({create(){return CompletionState.start()},
update(value,tr){return value.update(tr)},provide:f=>[view$jscomp$0.showTooltip.from(f,val=>val.tooltip),view$jscomp$0.EditorView.contentAttributes.from(f,state=>state.attrs)]});require=view=>{let cState=view.state.field(completionState,!1);if(view.state.readOnly||!cState||!cState.open||75>Date.now()-cState.open.timestamp)return!1;applyCompletion(view,cState.open.options[cState.open.selected]);return!0};module=view=>{if(!view.state.field(completionState,!1))return!1;view.dispatch({effects:startCompletionEffect.of(!0)});
return!0};const closeCompletion=view=>{let cState=view.state.field(completionState,!1);if(!cState||!cState.active.some(a=>0!=a.state))return!1;view.dispatch({effects:closeCompletionEffect.of(null)});return!0};class RunningQuery{constructor(active,context){this.active=active;this.context=context;this.time=Date.now();this.updates=[];this.done=void 0}}const completionPlugin=view$jscomp$0.ViewPlugin.fromClass(class{constructor(view){this.view=view;this.debounceUpdate=-1;this.running=[];this.debounceAccept=
-1;this.composing=0;for(let active of view.state.field(completionState).active)1==active.state&&this.startQuery(active)}update(update){let cState=update.state.field(completionState);if(update.selectionSet||update.docChanged||update.startState.field(completionState)!=cState){var doesReset=update.transactions.some(tr=>(tr.selection||tr.docChanged)&&!getUserEvent(tr));for(let i=0;i<this.running.length;i++){let query=this.running[i];if(doesReset||50<query.updates.length+update.transactions.length&&1E3<
Date.now()-query.time){for(let handler of query.context.abortListeners)try{handler()}catch(e){view$jscomp$0.logException(this.view.state,e)}query.context.abortListeners=null;this.running.splice(i--,1)}else query.updates.push(...update.transactions)}-1<this.debounceUpdate&&clearTimeout(this.debounceUpdate);this.debounceUpdate=cState.active.some(a=>1==a.state&&!this.running.some(q=>q.active.source==a.source))?setTimeout(()=>this.startUpdate(),50):-1;if(0!=this.composing)for(let tr of update.transactions)"input"==
getUserEvent(tr)?this.composing=2:2==this.composing&&tr.selection&&(this.composing=3)}}startUpdate(){this.debounceUpdate=-1;var {state}=this.view;state=state.field(completionState);for(let active of state.active)1!=active.state||this.running.some(r=>r.active.source==active.source)||this.startQuery(active)}startQuery(active){var {state}=this.view;let pos=cur(state);state=new CompletionContext(state,pos,active.explicitPos==pos);let pending=new RunningQuery(active,state);this.running.push(pending);Promise.resolve(active.source(state)).then(result=>
{pending.context.aborted||(pending.done=result||null,this.scheduleAccept())},err=>{this.view.dispatch({effects:closeCompletionEffect.of(null)});view$jscomp$0.logException(this.view.state,err)})}scheduleAccept(){this.running.every(q=>void 0!==q.done)?this.accept():0>this.debounceAccept&&(this.debounceAccept=setTimeout(()=>this.accept(),50))}accept(){var _a;-1<this.debounceAccept&&clearTimeout(this.debounceAccept);this.debounceAccept=-1;let updated=[],conf=this.view.state.facet(completionConfig);for(let i=
0;i<this.running.length;i++){let query=this.running[i];if(void 0!==query.done){this.running.splice(i--,1);if(query.done){var active=new ActiveResult(query.active.source,query.active.explicitPos,query.done,query.done.from,null!==(_a=query.done.to)&&void 0!==_a?_a:cur(query.updates.length?query.updates[0].startState:this.view.state));for(let tr of query.updates)active=active.update(tr,conf);if(active.hasResult()){updated.push(active);continue}}if((active=this.view.state.field(completionState).active.find(a=>
a.source==query.active.source))&&1==active.state)if(null==query.done){active=new ActiveSource(query.active.source,0);for(let tr of query.updates)active=active.update(tr,conf);1!=active.state&&updated.push(active)}else this.startQuery(active)}}updated.length&&this.view.dispatch({effects:setActiveEffect.of(updated)})}},{eventHandlers:{blur(){let state=this.view.state.field(completionState,!1);state&&state.tooltip&&this.view.state.facet(completionConfig).closeOnBlur&&this.view.dispatch({effects:closeCompletionEffect.of(null)})},
compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout(()=>this.view.dispatch({effects:startCompletionEffect.of(!1)}),20);this.composing=0}}}),baseTheme=view$jscomp$0.EditorView.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"\x26 \x3e ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",listStyle:"none",margin:0,padding:0,"\x26 \x3e li":{overflowX:"hidden",textOverflow:"ellipsis",
cursor:"pointer",padding:"1px 3px",lineHeight:1.2}}},"\x26light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"\x26dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"300px"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},
".cm-completionInfo.cm-completionInfo-right":{left:"100%"},"\x26light .cm-snippetField":{backgroundColor:"#00000022"},"\x26dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",
textAlign:"center",paddingRight:".6em",opacity:"0.6"},".cm-completionIcon-function, .cm-completionIcon-method":{"\x26:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"\x26:after":{content:"'○'"}},".cm-completionIcon-interface":{"\x26:after":{content:"'◌'"}},".cm-completionIcon-variable":{"\x26:after":{content:"'\ud835\udc65'"}},".cm-completionIcon-constant":{"\x26:after":{content:"'\ud835\udc36'"}},".cm-completionIcon-type":{"\x26:after":{content:"'\ud835\udc61'"}},".cm-completionIcon-enum":{"\x26:after":{content:"'∪'"}},
".cm-completionIcon-property":{"\x26:after":{content:"'□'"}},".cm-completionIcon-keyword":{"\x26:after":{content:"'\ud83d\udd11︎'"}},".cm-completionIcon-namespace":{"\x26:after":{content:"'▢'"}},".cm-completionIcon-text":{"\x26:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class FieldPos{constructor(field,line,from,to){this.field=field;this.line=line;this.from=from;this.to=to}}class FieldRange{constructor(field,from,to){this.field=field;this.from=from;this.to=to}map(changes){let from=
changes.mapPos(this.from,-1,state$jscomp$0.MapMode.TrackDel);changes=changes.mapPos(this.to,1,state$jscomp$0.MapMode.TrackDel);return null==from||null==changes?null:new FieldRange(this.field,from,changes)}}class Snippet{constructor(lines,fieldPositions){this.lines=lines;this.fieldPositions=fieldPositions}instantiate(state,pos$jscomp$0){let text=[],lineStart=[pos$jscomp$0];var lineObj=state.doc.lineAt(pos$jscomp$0);lineObj=/^\s*/.exec(lineObj.text)[0];for(let line of this.lines){if(text.length){let indent=
lineObj,tabs=/^\t*/.exec(line)[0].length;for(let i=0;i<tabs;i++)indent+=state.facet(language.indentUnit);lineStart.push(pos$jscomp$0+indent.length-tabs);line=indent+line.slice(tabs)}text.push(line);pos$jscomp$0+=line.length+1}state=this.fieldPositions.map(pos=>new FieldRange(pos.field,lineStart[pos.line]+pos.from,lineStart[pos.line]+pos.to));return{text,ranges:state}}static parse(template){let fields=[],lines=[],positions=[];for(let line of template.split(/\r\n?|\n/)){for(;template=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(line);){let seq=
template[1]?+template[1]:null,name=template[2]||template[3]||"";var found=-1;for(let i=0;i<fields.length;i++)if(null!=seq?fields[i].seq==seq:name&&fields[i].name==name)found=i;if(0>found){for(found=0;found<fields.length&&(null==seq||null!=fields[found].seq&&fields[found].seq<seq);)found++;fields.splice(found,0,{seq,name});for(let pos of positions)pos.field>=found&&pos.field++}positions.push(new FieldPos(found,lines.length,template.index,template.index+name.length));line=line.slice(0,template.index)+
name+line.slice(template.index+template[0].length)}for(;template=/([$#])\\{/.exec(line);){line=line.slice(0,template.index)+template[1]+"{"+line.slice(template.index+template[0].length);for(let pos of positions)pos.line==lines.length&&pos.from>template.index&&(pos.from--,pos.to--)}lines.push(line)}return new Snippet(lines,positions)}}let fieldMarker=view$jscomp$0.Decoration.widget({widget:new class extends view$jscomp$0.WidgetType{toDOM(){let span=document.createElement("span");span.className="cm-snippetFieldPosition";
return span}ignoreEvent(){return!1}}}),fieldRange=view$jscomp$0.Decoration.mark({class:"cm-snippetField"});class ActiveSnippet{constructor(ranges,active){this.ranges=ranges;this.active=active;this.deco=view$jscomp$0.Decoration.set(ranges.map(r=>(r.from==r.to?fieldMarker:fieldRange).range(r.from,r.to)))}map(changes){let ranges=[];for(let r of this.ranges){let mapped=r.map(changes);if(!mapped)return null;ranges.push(mapped)}return new ActiveSnippet(ranges,this.active)}selectionInsideField(sel){return sel.ranges.every(range=>
this.ranges.some(r=>r.field==this.active&&r.from<=range.from&&r.to>=range.to))}}const setActive=state$jscomp$0.StateEffect.define({map(value,changes){return value&&value.map(changes)}}),moveToField=state$jscomp$0.StateEffect.define(),snippetState=state$jscomp$0.StateField.define({create(){return null},update(value,tr){for(let effect of tr.effects){if(effect.is(setActive))return effect.value;if(effect.is(moveToField)&&value)return new ActiveSnippet(value.ranges,effect.value)}value&&tr.docChanged&&
(value=value.map(tr.changes));value&&tr.selection&&!value.selectionInsideField(tr.selection)&&(value=null);return value},provide:f=>view$jscomp$0.EditorView.decorations.from(f,val=>val?val.deco:view$jscomp$0.Decoration.none)}),clearSnippet=({state,dispatch})=>{if(!state.field(snippetState,!1))return!1;dispatch(state.update({effects:setActive.of(null)}));return!0},nextSnippetField=moveField(1),prevSnippetField=moveField(-1),defaultSnippetKeymap=[{key:"Tab",run:nextSnippetField,shift:prevSnippetField},
{key:"Escape",run:clearSnippet}],snippetKeymap=state$jscomp$0.Facet.define({combine(maps){return maps.length?maps[0]:defaultSnippetKeymap}}),addSnippetKeymap=state$jscomp$0.Prec.highest(view$jscomp$0.keymap.compute([snippetKeymap],state=>state.facet(snippetKeymap))),snippetPointerHandler=view$jscomp$0.EditorView.domEventHandlers({mousedown(event,view){let active=view.state.field(snippetState,!1),pos;if(!active||null==(pos=view.posAtCoords({x:event.clientX,y:event.clientY})))return!1;let match=active.ranges.find(r=>
r.from<=pos&&r.to>=pos);if(!match||match.field==active.active)return!1;view.dispatch({selection:fieldSelection(active.ranges,match.field),effects:setActive.of(active.ranges.some(r=>r.field>match.field)?new ActiveSnippet(active.ranges,match.field):null)});return!0}}),wordCaches=Object.create(null),defaults={brackets:["(","[","{","'",'"'],before:")]}:;\x3e"},closeBracketEffect=state$jscomp$0.StateEffect.define({map(value,mapping){value=mapping.mapPos(value,-1,state$jscomp$0.MapMode.TrackAfter);return null==
value?void 0:value}}),skipBracketEffect=state$jscomp$0.StateEffect.define({map(value,mapping){return mapping.mapPos(value)}}),closedBracket=new class extends state$jscomp$0.RangeValue{};closedBracket.startSide=1;closedBracket.endSide=-1;const bracketState=state$jscomp$0.StateField.define({create(){return state$jscomp$0.RangeSet.empty},update(value,tr){if(tr.selection){let lineStart=tr.state.doc.lineAt(tr.selection.main.head).from,prevLineStart=tr.startState.doc.lineAt(tr.startState.selection.main.head).from;
lineStart!=tr.changes.mapPos(prevLineStart,-1)&&(value=state$jscomp$0.RangeSet.empty)}value=value.map(tr.changes);for(let effect of tr.effects)effect.is(closeBracketEffect)?value=value.update({add:[closedBracket.range(effect.value,effect.value+1)]}):effect.is(skipBracketEffect)&&(value=value.update({filter:from=>from!=effect.value}));return value}}),android="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),inputHandler=view$jscomp$0.EditorView.inputHandler.of((view,from,to,insert)=>
{if((android?view.composing:view.compositionStarted)||view.state.readOnly)return!1;let sel=view.state.selection.main;if(2<insert.length||2==insert.length&&1==state$jscomp$0.codePointSize(state$jscomp$0.codePointAt(insert,0))||from!=sel.from||to!=sel.to)return!1;from=insertBracket(view.state,insert);if(!from)return!1;view.dispatch(from);return!0}),deleteBracketPair=({state:state$1,dispatch})=>{if(state$1.readOnly)return!1;let tokens=(state$1.languageDataAt("closeBrackets",state$1.selection.main.head)[0]||
defaults).brackets||defaults.brackets,dont=null,changes=state$1.changeByRange(range=>{if(range.empty){var JSCompiler_inline_result=range.head;JSCompiler_inline_result=state$1.doc.sliceString(JSCompiler_inline_result-2,JSCompiler_inline_result);JSCompiler_inline_result=state$jscomp$0.codePointSize(state$jscomp$0.codePointAt(JSCompiler_inline_result,0))==JSCompiler_inline_result.length?JSCompiler_inline_result:JSCompiler_inline_result.slice(1);for(let token of tokens)if(token==JSCompiler_inline_result&&
nextChar(state$1.doc,range.head)==closing(state$jscomp$0.codePointAt(token,0)))return{changes:{from:range.head-token.length,to:range.head+token.length},range:state$jscomp$0.EditorSelection.cursor(range.head-token.length),userEvent:"delete.backward"}}return{range:dont=range}});dont||dispatch(state$1.update(changes,{scrollIntoView:!0}));return!dont},closeBracketsKeymap=[{key:"Backspace",run:deleteBracketPair}],completionKeymap=[{key:"Ctrl-Space",run:module},{key:"Escape",run:closeCompletion},{key:"ArrowDown",
run:moveCompletionSelection(!0)},{key:"ArrowUp",run:moveCompletionSelection(!1)},{key:"PageDown",run:moveCompletionSelection(!0,"page")},{key:"PageUp",run:moveCompletionSelection(!1,"page")},{key:"Enter",run:require}],completionKeymapExt=state$jscomp$0.Prec.highest(view$jscomp$0.keymap.computeN([completionConfig],state=>state.facet(completionConfig).defaultKeymap?[completionKeymap]:[])),completionArrayCache=new WeakMap;exports.CompletionContext=CompletionContext;exports.acceptCompletion=require;exports.autocompletion=
function(config={}){return[completionState,completionConfig.of(config),completionPlugin,completionKeymapExt,baseTheme]};exports.clearSnippet=clearSnippet;exports.closeBrackets=function(){return[inputHandler,bracketState]};exports.closeBracketsKeymap=closeBracketsKeymap;exports.closeCompletion=closeCompletion;exports.completeAnyWord=context=>{let wordChars=context.state.languageDataAt("wordChars",context.pos).join(""),re=wordRE(wordChars);var token=context.matchBefore(mapRE(re,s=>s+"$"));if(!token&&
!context.explicit)return null;token=token?token.from:context.pos;context=collectWords(context.state.doc,wordCaches[wordChars]||(wordCaches[wordChars]=new WeakMap),re,5E4,token);return{from:token,options:context,validFor:mapRE(re,s=>"^"+s)}};exports.completeFromList=completeFromList;exports.completionKeymap=completionKeymap;exports.completionStatus=function(state){return(state=state.field(completionState,!1))&&state.active.some(a=>1==a.state)?"pending":state&&state.active.some(a=>0!=a.state)?"active":
null};exports.currentCompletions=function(state){var _a;state=null===(_a=state.field(completionState,!1))||void 0===_a?void 0:_a.open;if(!state)return[];(_a=completionArrayCache.get(state.options))||completionArrayCache.set(state.options,_a=state.options.map(o=>o.completion));return _a};exports.deleteBracketPair=deleteBracketPair;exports.ifIn=function(nodes,source){return context=>{for(let pos=language.syntaxTree(context.state).resolveInner(context.pos,-1);pos;pos=pos.parent)if(-1<nodes.indexOf(pos.name))return source(context);
return null}};exports.ifNotIn=function(nodes,source){return context=>{for(let pos=language.syntaxTree(context.state).resolveInner(context.pos,-1);pos;pos=pos.parent)if(-1<nodes.indexOf(pos.name))return null;return source(context)}};exports.insertBracket=insertBracket;exports.insertCompletionText=insertCompletionText;exports.moveCompletionSelection=moveCompletionSelection;exports.nextSnippetField=nextSnippetField;exports.pickedCompletion=global;exports.prevSnippetField=prevSnippetField;exports.selectedCompletion=
function(state){var _a;return(state=null===(_a=state.field(completionState,!1))||void 0===_a?void 0:_a.open)?state.options[state.selected].completion:null};exports.selectedCompletionIndex=function(state){var _a;return(state=null===(_a=state.field(completionState,!1))||void 0===_a?void 0:_a.open)?state.selected:null};exports.setSelectedCompletion=function(index){return setSelectedEffect.of(index)};exports.snippet=snippet;exports.snippetCompletion=function(template,completion){return Object.assign(Object.assign({},
completion),{apply:snippet(template)})};exports.snippetKeymap=snippetKeymap;exports.startCompletion=module}
//# sourceMappingURL=module$node_modules$$codemirror$autocomplete$dist$index_cjs.js.map
